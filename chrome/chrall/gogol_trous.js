"use strict";
var chrall = chrall || {};
var trous = [
	[-13, 73, -69], 
	[-13, 72, -69], 
	[-12, 73, -69], 
	[-12, 72, -69], 

	[-35, 65, -69], 
	[-35, 64, -69], 
	[-34, 65, -69], 
	[-34, 64, -69], 

	[-52, 57, -59], 

	[-35, 15, -69], 
	[-35, 14, -69], 
	[-34, 15, -69], 
	[-34, 14, -69], 

	[-64, 9, -69], 
	[-64, 8, -69], 
	[-63, 9, -69], 
	[-63, 8, -69], 

	[-71, -8, -69], 
	[-71, -7, -69], 
	[-70, -8, -69], 
	[-70, -7, -69], 

	[-51, -23, -69], 
	[-51, -22, -69], 
	[-50, -23, -69], 
	[-50, -22, -69], 

	[-60, -33, -69], 
	[-60, -32, -69], 
	[-59, -33, -69], 
	[-59, -32, -69], 

	[-67, -38, -69], 
	[-67, -37, -69], 
	[-66, -38, -69], 
	[-66, -37, -69], 

	[-36, -52, -69], 
	[-36, -51, -69], 
	[-35, -52, -69], 
	[-35, -51, -69], 

	[12, -15, -59], 

	[48, -39, -59], 

	[30, -52, -59], 


	[6, -50, -69], 
	[6, -49, -69], 
	[5, -50, -69], 
	[5, -49, -69], 

	[55, 70, -59], 

	[64, 70, -59], 

	[11, 64, -69], 
	[11, 63, -69], 
	[10, 64, -69], 
	[10, 63, -69], 

	[47, 52, -69], 
	[47, 51, -69], 
	[46, 52, -69], 
	[46, 51, -69], 

	[22, 36, -69], 
	[22, 35, -69], 
	[21, 36, -69], 
	[21, 35, -69], 

	[6, 32, -69], 
	[6, 31, -69], 
	[5, 32, -69], 
	[5, 31, -69], 

	[75, 32, -69], 
	[75, 31, -69], 
	[74, 32, -69], 
	[74, 31, -69], 

	[58, 32, -99], 
	[57, 32, -99], 
	[56, 32, -99], 
	[55, 32, -99], 
	[60, 31, -99],
	[59, 31, -99], 
	[58, 31, -99], 
	[57, 31, -99], 
	[56, 31, -99], 
	[55, 31, -99], 
	[54, 31, -99], 
	[53, 31, -99], 
	[62, 30, -99],
	[61, 30, -99], 
	[60, 30, -99], 
	[59, 30, -99], 
	[58, 30, -99], 
	[57, 30, -99], 
	[56, 30, -99], 
	[55, 30, -99], 
	[54, 30, -99], 
	[53, 30, -99], 
	[52, 30, -99], 
	[51, 30, -99], 
	[63, 29, -99],
	[62, 29, -99], 
	[61, 29, -99], 
	[60, 29, -99], 
	[59, 29, -99], 
	[58, 29, -99], 
	[57, 29, -99], 
	[56, 29, -99], 
	[55, 29, -99], 
	[54, 29, -99], 
	[53, 29, -99], 
	[52, 29, -99], 
	[51, 29, -99], 
	[50, 29, -99], 
	[63, 28, -99],
	[62, 28, -99], 
	[61, 28, -99], 
	[60, 28, -99], 
	[59, 28, -99], 
	[58, 28, -99], 
	[57, 28, -99], 
	[56, 28, -99], 
	[55, 28, -99], 
	[54, 28, -99], 
	[53, 28, -99], 
	[52, 28, -99], 
	[51, 28, -99], 
	[50, 28, -99], 
	[64, 27, -99],
	[63, 27, -99], 
	[62, 27, -99], 
	[61, 27, -99], 
	[60, 27, -99], 
	[59, 27, -99], 
	[58, 27, -99], 
	[57, 27, -99], 
	[56, 27, -99], 
	[55, 27, -99], 
	[54, 27, -99], 
	[53, 27, -99], 
	[52, 27, -99], 
	[51, 27, -99], 
	[50, 27, -99], 
	[49, 27, -99], 
	[64, 26, -99],
	[63, 26, -99], 
	[62, 26, -99], 
	[61, 26, -99], 
	[60, 26, -99], 
	[59, 26, -99], 
	[58, 26, -99], 
	[57, 26, -99], 
	[56, 26, -99], 
	[55, 26, -99], 
	[54, 26, -99], 
	[53, 26, -99], 
	[52, 26, -99], 
	[51, 26, -99], 
	[50, 26, -99], 
	[49, 26, -99], 
	[65, 25, -99],
	[64, 25, -99], 
	[63, 25, -99], 
	[62, 25, -99], 
	[61, 25, -99], 
	[60, 25, -99], 
	[59, 25, -99], 
	[58, 25, -99], 
	[57, 25, -99], 
	[56, 25, -99], 
	[55, 25, -99], 
	[54, 25, -99], 
	[53, 25, -99], 
	[52, 25, -99], 
	[51, 25, -99], 
	[50, 25, -99], 
	[49, 25, -99], 
	[48, 25, -99], 
	[65, 24, -99],
	[64, 24, -99], 
	[63, 24, -99], 
	[62, 24, -99], 
	[61, 24, -99], 
	[60, 24, -99], 
	[59, 24, -99], 
	[58, 24, -99], 
	[57, 24, -99], 
	[56, 24, -99], 
	[55, 24, -99], 
	[54, 24, -99], 
	[53, 24, -99], 
	[52, 24, -99], 
	[51, 24, -99], 
	[50, 24, -99], 
	[49, 24, -99], 
	[48, 24, -99], 
	[65, 23, -99],
	[64, 23, -99], 
	[63, 23, -99], 
	[62, 23, -99], 
	[61, 23, -99], 
	[60, 23, -99], 
	[59, 23, -99], 
	[58, 23, -99], 
	[57, 23, -99], 
	[56, 23, -99], 
	[55, 23, -99], 
	[54, 23, -99], 
	[53, 23, -99], 
	[52, 23, -99], 
	[51, 23, -99], 
	[50, 23, -99], 
	[49, 23, -99], 
	[48, 23, -99], 
	[65, 22, -99],
	[64, 22, -99], 
	[63, 22, -99], 
	[62, 22, -99], 
	[61, 22, -99], 
	[60, 22, -99], 
	[59, 22, -99], 
	[58, 22, -99], 
	[57, 22, -99], 
	[56, 22, -99], 
	[55, 22, -99], 
	[54, 22, -99], 
	[53, 22, -99], 
	[52, 22, -99], 
	[51, 22, -99], 
	[50, 22, -99], 
	[49, 22, -99], 
	[48, 22, -99], 
	[64, 21, -99],
	[63, 21, -99], 
	[62, 21, -99], 
	[61, 21, -99], 
	[60, 21, -99], 
	[59, 21, -99], 
	[58, 21, -99], 
	[57, 21, -99], 
	[56, 21, -99], 
	[55, 21, -99], 
	[54, 21, -99], 
	[53, 21, -99], 
	[52, 21, -99], 
	[51, 21, -99], 
	[50, 21, -99], 
	[49, 21, -99], 
	[64, 20, -99],
	[63, 20, -99], 
	[62, 20, -99], 
	[61, 20, -99], 
	[60, 20, -99], 
	[59, 20, -99], 
	[58, 20, -99], 
	[57, 20, -99], 
	[56, 20, -99], 
	[55, 20, -99], 
	[54, 20, -99], 
	[53, 20, -99], 
	[52, 20, -99], 
	[51, 20, -99], 
	[50, 20, -99], 
	[49, 20, -99], 
	[63, 19, -99],
	[62, 19, -99], 
	[61, 19, -99], 
	[60, 19, -99], 
	[59, 19, -99], 
	[58, 19, -99], 
	[57, 19, -99], 
	[56, 19, -99], 
	[55, 19, -99], 
	[54, 19, -99], 
	[53, 19, -99], 
	[52, 19, -99], 
	[51, 19, -99], 
	[50, 19, -99], 
	[63, 18, -99],
	[62, 18, -99], 
	[61, 18, -99], 
	[60, 18, -99], 
	[59, 18, -99], 
	[58, 18, -99], 
	[57, 18, -99], 
	[56, 18, -99], 
	[55, 18, -99], 
	[54, 18, -99], 
	[53, 18, -99], 
	[52, 18, -99], 
	[51, 18, -99], 
	[50, 18, -99], 
	[62, 17, -99],
	[61, 17, -99], 
	[60, 17, -99], 
	[59, 17, -99], 
	[58, 17, -99], 
	[57, 17, -99], 
	[56, 17, -99], 
	[55, 17, -99], 
	[54, 17, -99], 
	[53, 17, -99], 
	[52, 17, -99], 
	[51, 17, -99], 
	[60, 16, -99],
	[59, 16, -99], 
	[58, 16, -99], 
	[57, 16, -99], 
	[56, 16, -99], 
	[55, 16, -99], 
	[54, 16, -99], 
	[53, 16, -99], 
	[58, 15, -99],
	[57, 15, -99], 
	[56, 15, -99], 
	[55, 15, -99]
];

chrall.ajouteTrous = function(ch) {
	for (var i=trous.length; i-->0;) {
		ch.add(new chrall.ChTrou(trous[i][0], trous[i][1]));
	}
}

// construit le message affiché lors du paramétrage d'un TP
chrall.teleportHoleMessage = function(x, y, z){
	var smallestSquaredDist, nearestHole;
	for (var i=0; i<trous.length; i++) {
		var	h = trous[i],
			dz = Math.min(0, z-h[2]),
			squaredDist = (x-h[0])*(x-h[0])+(y-h[1])*(y-h[1])+dz*dz;
		if (!(smallestSquaredDist<=squaredDist)) {
			smallestSquaredDist = squaredDist;
			nearestHole = h;
		}
	}
	var str = "";
	if (smallestSquaredDist===0) {
		return "Vous visez un trou de météorite !";
	} else if (smallestSquaredDist<10) {
		str += "Attention ! ";
	}
	return str + "Trou le plus proche à "+
		Math.round(Math.sqrt(smallestSquaredDist))+
		" cases : X="+nearestHole[0]+", Y="+nearestHole[1];
}
